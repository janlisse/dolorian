@(workItemMap: Map[Project, List[WorkItem]])(implicit flash: Flash, session: Session)

@import utils._
@import views.html.helper._ 
@implicitField = @{FieldConstructor(views.html.helper.twitterBootstrapFieldConstructor.f) }

@headContent = {
	<link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/bootstrap-datepicker.css")">
	<script src='@routes.Assets.at("javascripts/bootstrap-datepicker.js")' type='text/javascript' ></script>
	<script src='@routes.Assets.at("javascripts/moment-2.3.1.min.js")' type='text/javascript' ></script>
	<script src='@routes.Assets.at("javascripts/workitem_search.js")' type='text/javascript' ></script>
	<script>
		$(function () {
		    $('#projectTab a').click(function (e) {
		        e.preventDefault();
		        $(this).tab('show');
		    })
		    $('#projectTab a:first').tab('show');
		})
</script>
}

@main(title = Messages("workitem.list.title"), headContent) {
	
	<form id="filterForm" class="form-inline">
		<h4>@Messages("workitem.rangeSelect")</h4>
		<select id="rangeSelect" name="rangeSelect">
			<option value="currentMonth">@Messages("workitem.rangeSelect.currentMonth")</option>
			<option value="lastMonth">@Messages("workitem.rangeSelect.lastMonth")</option>
		</select>
	</form>
	
	@if(workItemMap.isEmpty) {
		<div class="alert alert-info">@Messages("workitem.list.empty")</div>
    }
		
	<ul id="projectTab" class="nav nav-tabs">
		@for(project <- workItemMap.keys) {
		  <li><a href="#project@project.id">@project.number</a></li>
		}
	</ul>
		
	<div class="tab-content">
		@for((project,workItems) <- workItemMap) {
	    	<div id="project@project.id" rel="@project.id" class="tab-pane">
		    	 
		        <h3>@Messages("workitem.list.title")</h3>
				
		        <table class="table table-striped table-hover table-condensed">
		            <thead>
		                <tr>
		                    <th>@Messages("workitem.date")</th>
		                    <th>@Messages("workitem.start")</th>
		                    <th>@Messages("workitem.end")</th>
		                    <th>@Messages("workitem.break")</th>
		                    <th>@Messages("workitem.totalTime")</th>
		                    <th>@Messages("workitem.description")</th>
		                    <th>@Messages("list.actions")</th>
		                </tr>
		            </thead>
		            <tbody>
		            @workItems.map { work =>
		                <tr>
		                    <td>@FormatUtil.formatDate(work.startTime)</td>
		                    <td>@FormatUtil.formatTime(work.startTime)</td>
		                    <td>@FormatUtil.formatTime(work.endTime)</td>
		                    <td>@work.breakTime min</td>
		                    <td>@work.totalTimeFormatted</td>
		                    <td>@work.description</td>
		                    <td>
		                        <div class='btn btn-info'><i class="icon-edit icon-white"></i></div>
		                        @helper.form(routes.WorkItems.delete(work.id.get)) {
		                            <button type="submit" class='btn btn-danger'><i class="icon-trash icon-white"></i></button>
		                        }
		                    </td>
		                </tr>
		            }
		        </table>
		    <a id="reportButton" class="btn btn-inverse" href="#">@Messages("workitem.report")</a>    
	    </div>
	  }
    </div>  
}